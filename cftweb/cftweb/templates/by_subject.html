{% extends "base.jinja" %}
{% block page_css %}
<style>
  tr.clickable-row { cursor: pointer; } 
</style>
<script>
jQuery(document).ready(function($) {
    $(".clickable-row").click(function() {
        var newLocation = $(this).data("href");
        console.log("The new location is: " + newLocation);
        window.location = newLocation;
    });
  });
</script>
{% endblock %}

{% block content %}
<h2>Clusters Grouped by Subject</h2>
<div class="row">
  <div class="col-md-6">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
        <th>Subject ID</th>
        <th>seeds</th>
        <th>clusters</th>
        </tr>
      </thead>
      <tbody>
      {% for group in clusters | groupby('subject_id') %}
      {% set subject_id = group.grouper %}
      {% set slist = group.list | map(attribute='seed') | list | unique -%}
      {% set ns = slist | length -%}
      {% set nc = group.list | length -%}
        <tr class='clickable-row' data-href='{{ url_for('by_seed', dataset_id=dataset_id, subject_id=subject_id) }}'>
          <td>{{ subject_id }}</td>
          <td>{{ ns }} seed{{ "s" if ns > 1 else ""}}</td>
          <td>{{ nc }} cluster{{ "s" if nc > 1 else ""}}</td>
        </tr>
      {%- endfor -%}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}

